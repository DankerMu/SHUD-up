# TSR (Terrain Solar Radiation) 升级效果验证报告

**生成日期**: 2025-01-16
**研究区**: CCW (Cache Creek Watershed)
**模拟时段**: 1827 天

---

## 1. 实验设计

| 实验 | 目录 | TSR状态 | 说明 |
|------|------|---------|------|
| 基准 | `output/ccw_base.out` | OFF | 原始水平面辐射 |
| TSR | `output/ccw_tsr` | ON | 地形修正辐射 |

## 2. TSR 诊断变量分析

### 2.1 TSR 因子分布

| 统计量 | rn_factor | 实际辐射比值 (rn_t/rn_h) |
|--------|-----------|------------------------|
| 均值 | 0.525 | 0.988 |
| 最小值 | 0.000 | 0.000 |
| 最大值 | 0.994 | **2.091** |
| P25 | 0.460 | - |
| P50 | 0.547 | - |
| P75 | 0.613 | - |

### 2.2 辐射修正效果

| 指标 | 值 |
|------|-----|
| 水平面辐射均值 (rn_h) | 220.91 W/m² |
| 地形修正辐射均值 (rn_t) | 216.62 W/m² |
| 辐射增强比例 (ratio > 1) | **42.2%** |
| 辐射削弱比例 (ratio < 1) | **57.8%** |
| 最大增强倍数 | 2.09x |

**物理解释**：
- 42.2% 的单元-时刻组合接收到更多辐射（朝向太阳的斜坡）
- 57.8% 接收到更少辐射（背向太阳或被遮蔽的斜坡）
- 研究区整体略偏向辐射削弱（山区北坡较多）

## 3. 水文变量响应

### 3.1 蒸散发相关变量

| 变量 | 基准均值 | TSR均值 | 相对变化 | 说明 |
|------|----------|---------|----------|------|
| ET (实际蒸散发) | 1.399e-3 | 1.391e-3 | **-0.54%** | 减少 |
| PET (潜在蒸散发) | 4.636e-3 | 4.581e-3 | **-1.19%** | 减少 |
| 蒸发 | 4.096e-4 | 4.051e-4 | **-1.11%** | 减少 |
| 蒸腾 | 9.450e-4 | 9.429e-4 | -0.22% | 轻微减少 |
| 冠层截留蒸发 | 4.409e-5 | 4.316e-5 | **-2.14%** | 减少 |

**物理机制**：TSR 使平均辐射略减（-2%），导致蒸散发降低。

### 3.2 水量平衡变量

| 变量 | 基准均值 | TSR均值 | 相对变化 | 说明 |
|------|----------|---------|----------|------|
| 非饱和带水量 | 8.589 | 8.607 | **+0.21%** | 增加 |
| 地下水位 | 2.714 | 2.714 | -0.01% | 基本不变 |
| 河道流量 | 5555 | 5509 | **-0.84%** | 减少 |

**物理机制**：蒸散发减少 → 土壤水分保留增加 → 非饱和带水量上升。

## 4. 空间差异分析

TSR 效果因地形而异：

- **朝南斜坡** (北半球)：辐射增强 → ET增加
- **朝北斜坡**：辐射削弱 → ET减少
- **研究区整体**：北坡占优，导致平均 ET 减少

## 5. 结论

### 5.1 TSR 功能验证

✅ **TSR 升级已正确实现并生效**

- 诊断输出 (rn_h, rn_t, rn_factor) 正常
- 辐射修正符合物理预期（42%增强，58%削弱）
- 水文变量响应合理（蒸散发减少，土壤水增加）

### 5.2 影响量级

| 影响程度 | 变量 |
|----------|------|
| 显著 (>1%) | PET, 蒸发, 冠层截留 |
| 中等 (0.5-1%) | ET, 河道流量 |
| 轻微 (<0.5%) | 蒸腾, 非饱和带, 地下水 |

### 5.3 建议

1. **山区应用**：TSR 对山区水文模拟有显著改进
2. **平原应用**：平坦地区可关闭 TSR 节省计算
3. **敏感性**：建议对特定研究区进行 TSR 敏感性分析

---

## 附录：配置参数

```
TERRAIN_RADIATION    1
SOLAR_UPDATE_INTERVAL    60  (分钟)
RAD_FACTOR_CAP    5.0
RAD_COSZ_MIN    0.05
RADIATION_INPUT_MODE    SWDOWN
SOLAR_LONLAT_MODE    FORCING_FIRST
```

---
*报告由 post_analysis/compare_tsr.py 自动生成*
